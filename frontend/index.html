<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="style.css">
  <title>Altschool QuickOrder App</title>
</head>
  
<body>
  <div class="app">
 <div class="header">
  <div class="logo">
    <img class="user-profile" src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR21AmU4J2MeB03a220QqZibuCBaasBSJQ16HkbtRq83T_e6pUizWj1M19zZ7-VAFCHC9I&usqp=CAU" alt="" class="account-profile" alt="">
   <h3>QuickOrder</h3>
  </div>
  
  <div class="user-settings">
   <div class="dark-light">
    <svg viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round">
     <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z" /></svg>
   </div>
   <img class="user-profile" src="https://cdn3.iconfinder.com/data/icons/vector-icons-6/96/256-512.png" alt="" class="account-profile" alt="">
  </div>
 </div>
 <div class="wrapper">
  <div class="conversation-area">
   <div class="msg">
    <img class="msg-profile" src="https://www.rawshorts.com/freeicons/wp-content/uploads/2017/01/orange_travelpictdinner_1484336833.png" alt="" />
    <div class="msg-detail">
     <div class="msg-username">Order Id</div>
     <div class="msg-content">
      <span class="msg-message">21/02/2023</span>
      <span class="msg-date">12:30</span>
     </div>
    </div>
   </div>
   <div class="msg">
    <img class="msg-profile" src="https://www.rawshorts.com/freeicons/wp-content/uploads/2017/01/orange_travelpictdinner_1484336833.png" alt="" />
    <div class="msg-detail">
      <div class="msg-username">Order Id</div>
      <div class="msg-content">
       <span class="msg-message">21/02/2023</span>
       <span class="msg-date">12:30</span>
      </div>
    </div>
   </div>
   <div class="msg">
    <img class="msg-profile" src="https://www.rawshorts.com/freeicons/wp-content/uploads/2017/01/orange_travelpictdinner_1484336833.png" alt="" />
    <div class="msg-detail">
      <div class="msg-username">Order Id</div>
      <div class="msg-content">
       <span class="msg-message">21/02/2023</span>
       <span class="msg-date">12:30</span>
      </div>
    </div>
   </div>
   <div class="msg">
    <img class="msg-profile" src="https://www.rawshorts.com/freeicons/wp-content/uploads/2017/01/orange_travelpictdinner_1484336833.png" alt="" />
    <div class="msg-detail">
     <div class="msg-username">Order Id</div>
     <div class="msg-content">
      <span class="msg-message">21/02/2023</span>
      <span class="msg-date">12:30</span>
     </div>
    </div>
   </div>
   <div class="msg">
    <img class="msg-profile" src="https://www.rawshorts.com/freeicons/wp-content/uploads/2017/01/orange_travelpictdinner_1484336833.png" alt="" />
    <div class="msg-detail">
      <div class="msg-username">Order Id</div>
      <div class="msg-content">
       <span class="msg-message">21/02/2023</span>
       <span class="msg-date">12:30</span>
      </div>
    </div>
   </div>
   <div class="msg">
    <img class="msg-profile" src="https://www.rawshorts.com/freeicons/wp-content/uploads/2017/01/orange_travelpictdinner_1484336833.png" alt="" />
    <div class="msg-detail">
      <div class="msg-username">Order Id</div>
      <div class="msg-content">
       <span class="msg-message">21/02/2023</span>
       <span class="msg-date">12:30</span>
      </div>
    </div>
   </div>
   <div class="msg">
    <img class="msg-profile" src="https://www.rawshorts.com/freeicons/wp-content/uploads/2017/01/orange_travelpictdinner_1484336833.png" alt="">
    <div class="msg-detail">
      <div class="msg-username">Order Id</div>
      <div class="msg-content">
       <span class="msg-message">21/02/2023</span>
       <span class="msg-date">12:30</span>
      </div>
    </div>
   </div>
   <div class="msg">
    <img class="msg-profile" src="https://www.rawshorts.com/freeicons/wp-content/uploads/2017/01/orange_travelpictdinner_1484336833.png" alt="" />
    <div class="msg-detail">
      <div class="msg-username">Order Id</div>
      <div class="msg-content">
       <span class="msg-message">21/02/2023</span>
       <span class="msg-date">12:30</span>
      </div>
    </div>
   </div>
   <div class="msg">
    <img class="msg-profile" src="https://www.rawshorts.com/freeicons/wp-content/uploads/2017/01/orange_travelpictdinner_1484336833.png" alt="" />
    <div class="msg-detail">
      <div class="msg-username">Order Id</div>
      <div class="msg-content">
       <span class="msg-message">21/02/2023</span>
       <span class="msg-date">12:30</span>
      </div>
    </div>
   </div>
   <div class="msg">
    <img class="msg-profile" src="https://www.rawshorts.com/freeicons/wp-content/uploads/2017/01/orange_travelpictdinner_1484336833.png" alt="" />
    <div class="msg-detail">
      <div class="msg-username">Order Id</div>
      <div class="msg-content">
       <span class="msg-message">21/02/2023</span>
       <span class="msg-date">12:30</span>
      </div>
    </div>
   </div>
   <div class="overlay"></div>
  </div>
  <div class="chat-area">
   <div class="chat-area-header">
    <div class="chat-area-title">QuickOrder Bot</div>
    <div class="chat-area-group">
     <img class="chat-area-profile" src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/3364143/download+%281%29.png" alt="" />
     <span>+4</span>
    </div>
   </div>
   <div class="chat-area-main">
   </div>
   <div class="chat-area-footer">
    <input type="text" placeholder="Type something here..." id="chat-input" required />
    <img src="send.svg" alt="" id="send-message">
   </div>
  </div>
  <div class="detail-area">
   <div class="detail-area-header">
    <div class="msg-profile group">
      <img class="user-profile" src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR21AmU4J2MeB03a220QqZibuCBaasBSJQ16HkbtRq83T_e6pUizWj1M19zZ7-VAFCHC9I&usqp=CAU" alt="" class="account-profile" alt="">
    </div>
    <div class="detail-title">QuickOrder</div>
    <div class="detail-subtitle">Joined, 1 May 2020</div>
    <div class="detail-buttons">
     <button class="detail-button">
      <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="currentColor" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" class="feather feather-phone">
       <path d="M22 16.92v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07 19.5 19.5 0 01-6-6 19.79 19.79 0 01-3.07-8.67A2 2 0 014.11 2h3a2 2 0 012 1.72 12.84 12.84 0 00.7 2.81 2 2 0 01-.45 2.11L8.09 9.91a16 16 0 006 6l1.27-1.27a2 2 0 012.11-.45 12.84 12.84 0 002.81.7A2 2 0 0122 16.92z" />
      </svg>
      Call Support
     </button>
     <button class="detail-button">
      <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="currentColor" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" class="feather feather-video">
       <path d="M23 7l-7 5 7 5V7z" />
       <rect x="1" y="5" width="15" height="14" rx="2" ry="2" /></svg>
      Video Chat
     </button>
    </div>
   </div>
   <div class="detail-changes">
    <input type="text" placeholder="Search in Conversation">
    <div class="detail-change">
     Change Color
     <div class="colors">
      <div class="color blue selected" data-color="blue"></div>
      <div class="color purple" data-color="purple"></div>
      <div class="color green" data-color="green"></div>
      <div class="color orange" data-color="orange"></div>
     </div>
    </div>
   </div>
   <a href="https://twitter.com/AysnrTrkk" class="follow-me" target="_blank">
    <span class="follow-text">
     <svg viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1">
      <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path>
     </svg>
     Follow me on Twitter
    </span>
    <span class="developer">
     <img src="https://avatars.githubusercontent.com/u/65337929?v=4" />
     David Udo â€” @_davidudo
    </span>
   </a>
  </div>
 </div>
</div>

<script src="https://cdn.socket.io/4.6.1/socket.io.min.js"></script>
<script>
  const socket = io('ws://localhost:8000')

  let chatAreaMain = document.querySelector('.chat-area-main')
  const chatInput = document.querySelector('#chat-input')
  const sendMessageBtn = document.querySelector('#send-message')
  let customerId = localStorage.getItem('customerId')

  let imgSrc = 'https://s3-us-west-2.amazonaws.com/s.cdpn.io/3364143/download+%281%29.png'
  let chatMessage = ''
  let chatMsg = ''
  
  let currentDate = new Date()
  let dateOptions = {weekday: 'short', month: 'short', day: 'numeric'}
  const timeOptions = {hour: 'numeric', minute: 'numeric'}

  let readableDate = currentDate.toLocaleDateString('en-US', dateOptions)
  let readableTime = currentDate.toLocaleTimeString('en-US', timeOptions)

  if (customerId === null || customerId === undefined) {
    socket.emit('id-customer', customerId)
  } else {
    socket.on('connected', (data) => {
      console.log(data)
      chatMessage = data

      chatMsg = `
        <div class="chat-msg">
        <div class="chat-msg-profile">
          <img class="chat-msg-img" src=${imgSrc} alt="" />
          <div class="chat-msg-date">Received ${readableDate} ${readableTime}</div>
        </div>
        <div class="chat-msg-content">
          <div class="chat-msg-text">${chatMessage}</div>
        </div>
        </div>
      `
      chatAreaMain.insertAdjacentHTML('beforeend', chatMsg)
    })
  }

  console.log('customerId', customerId)

  socket.on('id-customer', (data) => {
    console.log(data)
    chatMessage = data

    chatMsg = `
      <div class="chat-msg">
      <div class="chat-msg-profile">
        <img class="chat-msg-img" src=${imgSrc} alt="" />
        <div class="chat-msg-date">Received ${readableDate} ${readableTime}</div>
      </div>
      <div class="chat-msg-content">
        <div class="chat-msg-text">${chatMessage}</div>
      </div>
      </div>
    `
    chatAreaMain.insertAdjacentHTML('beforeend', chatMsg)
  })

  socket.on('store-customer', (data) => {
    console.log(data)
    localStorage.setItem('customerId', data.id)
    localStorage.setItem('customerName', data.name)

    socket.on('connected', (data) => {
      console.log(data)
      chatMessage = data

      chatMsg = `
        <div class="chat-msg">
        <div class="chat-msg-profile">
          <img class="chat-msg-img" src=${imgSrc} alt="" />
          <div class="chat-msg-date">Received ${readableDate} ${readableTime}</div>
        </div>
        <div class="chat-msg-content">
          <div class="chat-msg-text">${chatMessage}</div>
        </div>
        </div>
      `
      chatAreaMain.insertAdjacentHTML('beforeend', chatMsg)
    })
  })

  sendMessageBtn.addEventListener('click', () => {
    let chatInputValue = chatInput.value

    if (chatInputValue === '') {
      alert('Please enter a numnber')
      return
    }

    if (customerId === null || customerId === undefined) {
      socket.emit('create-customer', chatInputValue)
      
      chatMessage = chatInputValue
      imgSrc = 'https://cdn3.iconfinder.com/data/icons/vector-icons-6/96/256-512.png'
      currentDate = new Date()
      readableDate = currentDate.toLocaleDateString('en-US', dateOptions)
      readableTime = currentDate.toLocaleTimeString('en-US', timeOptions)


      chatMsg = `
        <div class="chat-msg owner">
        <div class="chat-msg-profile">
          <img class="chat-msg-img" src=${imgSrc} alt="" />
          <div class="chat-msg-date">Sent ${readableDate} ${readableTime}</div>
        </div>
        <div class="chat-msg-content">
          <div class="chat-msg-text">${chatMessage}</div>
        </div>
        </div>
      `
      chatAreaMain.insertAdjacentHTML('beforeend', chatMsg)

      chatInput.value = ''
    } else {
      let optionData = {
        option: Number(chatInputValue) || 1,
        customerId: 1
      }

      socket.emit('select-options', optionData)

      chatMessage = chatInputValue
      imgSrc = 'https://cdn3.iconfinder.com/data/icons/vector-icons-6/96/256-512.png'
      currentDate = new Date()
      readableDate = currentDate.toLocaleDateString('en-US', dateOptions)
      readableTime = currentDate.toLocaleTimeString('en-US', timeOptions)


      chatMsg = `
        <div class="chat-msg owner">
        <div class="chat-msg-profile">
          <img class="chat-msg-img" src=${imgSrc} alt="" />
          <div class="chat-msg-date">Sent ${readableDate} ${readableTime}</div>
        </div>
        <div class="chat-msg-content">
          <div class="chat-msg-text">${chatMessage}</div>
        </div>
        </div>
      `
      chatAreaMain.insertAdjacentHTML('beforeend', chatMsg)

      chatInput.value = ''
    }
  })

  socket.on('order-status', (data) => {
    console.log(data)
  })

  socket.on('invalid-number', (data) => {
    chatMessage = data
    imgSrc = 'https://s3-us-west-2.amazonaws.com/s.cdpn.io/3364143/download+%281%29.png'
    currentDate = new Date()
    readableDate = currentDate.toLocaleDateString('en-US', dateOptions)
    readableTime = currentDate.toLocaleTimeString('en-US', timeOptions)

    chatMsg = `
      <div class="chat-msg">
      <div class="chat-msg-profile">
        <img class="chat-msg-img" src=${imgSrc} alt="" />
        <div class="chat-msg-date">Sent ${readableDate} ${readableTime}</div>
      </div>
      <div class="chat-msg-content">
        <div class="chat-msg-text">${chatMessage}</div>
      </div>
      </div>
     `

    chatAreaMain.insertAdjacentHTML('beforeend', chatMsg)
  })

  socket.on('cancel-order', (data) => {
    chatMessage = data
    imgSrc = 'https://s3-us-west-2.amazonaws.com/s.cdpn.io/3364143/download+%281%29.png'
    currentDate = new Date()
    readableDate = currentDate.toLocaleDateString('en-US', dateOptions)
    readableTime = currentDate.toLocaleTimeString('en-US', timeOptions)

    chatMsg = `
      <div class="chat-msg">
      <div class="chat-msg-profile">
        <img class="chat-msg-img" src=${imgSrc} alt="" />
        <div class="chat-msg-date">Sent ${readableDate} ${readableTime}</div>
      </div>
      <div class="chat-msg-content">
        <div class="chat-msg-text">${chatMessage}</div>
      </div>
      </div>
     `

    chatAreaMain.insertAdjacentHTML('beforeend', chatMsg)
  })

  socket.on('place-order', (data) => {
    console.log(data)
    chatMessage = data
    imgSrc = 'https://s3-us-west-2.amazonaws.com/s.cdpn.io/3364143/download+%281%29.png'
    currentDate = new Date()
    readableDate = currentDate.toLocaleDateString('en-US', dateOptions)
    readableTime = currentDate.toLocaleTimeString('en-US', timeOptions)

    chatMsg = `
      <div class="chat-msg">
      <div class="chat-msg-profile">
        <img class="chat-msg-img" src=${imgSrc} alt="" />
        <div class="chat-msg-date">Sent ${readableDate} ${readableTime}</div>
      </div>
      <div class="chat-msg-content">
        <div class="chat-msg-text">${chatMessage}</div>
      </div>
      </div>
     `

    chatAreaMain.insertAdjacentHTML('beforeend', chatMsg)
  })

  socket.on('order-history', (data) => {
    chatMessage = data
    imgSrc = 'https://s3-us-west-2.amazonaws.com/s.cdpn.io/3364143/download+%281%29.png'
    currentDate = new Date()
    readableDate = currentDate.toLocaleDateString('en-US', dateOptions)
    readableTime = currentDate.toLocaleTimeString('en-US', timeOptions)

    chatMsg = `
      <div class="chat-msg">
      <div class="chat-msg-profile">
        <img class="chat-msg-img" src=${imgSrc} alt="" />
        <div class="chat-msg-date">Sent ${readableDate} ${readableTime}</div>
      </div>
      <div class="chat-msg-content">
        <div class="chat-msg-text">${chatMessage}</div>
      </div>
      </div>
     `

    chatAreaMain.insertAdjacentHTML('beforeend', chatMsg)
  })

  socket.on('current-order', (data) => {
    chatMessage = data
    imgSrc = 'https://s3-us-west-2.amazonaws.com/s.cdpn.io/3364143/download+%281%29.png'
    currentDate = new Date()
    readableDate = currentDate.toLocaleDateString('en-US', dateOptions)
    readableTime = currentDate.toLocaleTimeString('en-US', timeOptions)

    chatMsg = `
      <div class="chat-msg">
      <div class="chat-msg-profile">
        <img class="chat-msg-img" src=${imgSrc} alt="" />
        <div class="chat-msg-date">Sent ${readableDate} ${readableTime}</div>
      </div>
      <div class="chat-msg-content">
        <div class="chat-msg-text">${chatMessage}</div>
      </div>
      </div>
     `

    chatAreaMain.insertAdjacentHTML('beforeend', chatMsg)
  })

</script>
<script src="main.js"></script>
</body>

</html>